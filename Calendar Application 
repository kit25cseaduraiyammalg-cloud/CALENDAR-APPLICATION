#include <stdio.h>
#include <string.h>
#include <stdlib.h>
int daysInMonth(int m, int y) {
    int d[] = {31,28,31,30,31,30,31,31,30,31,30,31};
    if (m == 2 && (y % 400 == 0 || (y % 4 == 0 && y % 100 != 0))) {
        return 29;
    }
    return d[m - 1];
}
int startWeekday(int d, int m, int y) {
    static int t[] = {0,3,2,5,0,3,5,1,4,6,2,4};
    if (m < 3) y--;
    return (y + y/4 - y/100 + y/400 + t[m-1] + d) % 7;
}
int main() {
    char *months[] = {"","jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"};
    char *events[] = {"","New Year - Jan 1","Valentine's Day - Feb 14","Women's Day - Mar 8",
                      "No major events","May Day - May 1","Environment Day - Jun 5",
                      "No major events","Independence Day - Aug 15","Teachers Day - Sep 5",
                      "Gandhi Jayanti - Oct 2","Children's Day - Nov 14","Christmas - Dec 25"};
    char input[50];
    int month = 0, year;
    printf("Enter month and year: ");
    fgets(input, sizeof(input), stdin);
    int len = strlen(input);
    if (input[len - 1] == '\n') {
        input[--len] = '\0';
    }
    if (len < 5) {
        printf("Invalid input\n");
        getchar();
        getchar();
        return 0;
    }
    for (int i = 0; i < len; i++) {
        if (!((input[i] >= '0' && input[i] <= '9') ||
              (input[i] >= 'A' && input[i] <= 'Z') ||
              (input[i] >= 'a' && input[i] <= 'z') ||
              input[i] == ' ')) {
            printf("Invalid input\n");
            getchar();
            getchar();
            return 0;
        }
    }
    int y1 = len - 2;
    if(len >= 4 && input[len-4] >= '0' && input[len-4] <= '9') {
        y1 = len - 4;
    }
    char monthstr[20];
    for(int i = 0; i < y1; i++) {
        monthstr[i] = input[i];
    }
    monthstr[y1] = '\0';
    year = atoi(&input[y1]);
    for(int i = y1; i < len; i++) {
        if(input[i] < '0' || input[i] > '9') {
            printf("Invalid input\n");
            getchar(); getchar();
            return 0;
        }
    }
    if(year < 100) {
        year += 2000;
    }
    for (int i = 1; i <= 12; i++) {
        if (strncasecmp(input, months[i], 3) == 0) {
            month = i;
            break;
        }
    }
    if (month == 0) {
        month = atoi(input);
    }
    if (month < 1 || month > 12) {
        printf("Invalid input\n");
        getchar();
        getchar();
        return 0;
    }
    int days = daysInMonth(month, year);
    int start = startWeekday(1, month, year);
    printf("\nSun Mon Tue Wed Thu Fri Sat\n");
    for (int i = 0; i < start; i++) printf("    ");

    for (int d = 1; d <= days; d++) {
        printf("%3d ", d);
        if ((d + start) % 7 == 0) printf("\n");
    }
    printf("\n\nSpecial Event: %s\n", events[month]);
    getchar();
    getchar();
    return 0;
}